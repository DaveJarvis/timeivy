var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var b=function(){};b.prototype=a;return new b};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},b={};try{return b.__proto__=a,b.a}catch(d){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,b){a.prototype=$jscomp.objectCreate(b.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var d=$jscomp.setPrototypeOf;d(a,b)}else for(d in b)if("prototype"!=d)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d];a.superClass_=b.prototype};
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};
$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};
$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var d=0,e={next:function(){if(d<a.length){var g=d++;return{value:b(g,a[g]),done:!1}}e.next=function(){return{done:!0,value:void 0}};return e.next()}};e[Symbol.iterator]=function(){return e};return e};
$jscomp.polyfill=function(a,b,d,e){if(b){d=$jscomp.global;a=a.split(".");for(e=0;e<a.length-1;e++){var g=a[e];g in d||(d[g]={});d=d[g]}a=a[a.length-1];e=d[a];b=b(e);b!=e&&null!=b&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
(function(a,b,d,e){function g(c,k){this.element=c;this.settings=a.extend({},q,k);this._defaults=q;this._name="ivy";this._cell=[0,0];this._$cellInput=!1;this._commandExecutor=new h;this.init()}var q={classActiveCell:"active",classActiveCellInput:"edit",maxPageSize:30,maxUndoLevels:1E3,modeNavigate:[{k:"left",f:"navigateLeft"},{k:"right",f:"navigateRight"},{k:"up",f:"navigateUp"},{k:"down",f:"navigateDown"},{k:"ctrl+left",f:"navigateLeftSkip"},{k:"ctrl+right",f:"navigateRightSkip"},{k:"ctrl+up",f:"navigateUpSkip"},
{k:"ctrl+down",f:"navigateDownSkip"},{k:"pageup",f:"navigatePageUp"},{k:"pagedown",f:"navigatePageDown"},{k:"ctrl+pageup",f:"navigateSheetFore"},{k:"ctrl+pagedown",f:"navigateSheetAnte"},{k:"home",f:"navigateRowHome"},{k:"end",f:"navigateRowEnd"},{k:"ctrl+home",f:"navigateHome"},{k:"ctrl+end",f:"navigateEnd"},{k:"shift+tab",f:"navigateLeft"},{k:"tab",f:"navigateRight"},{k:"ctrl+x",f:"cellCut"},{k:"ctrl+c",f:"cellCopy"},{k:"ctrl+ins",f:"cellCopy"},{k:"del",f:"cellErase"},{k:"f2",f:"cellEditStart"},
{k:"enter",f:"cellEditStart"},{k:"esc",f:"cellEditCancel"},{k:"ins",f:"editInsertRowAfter"},{k:"alt+ins",f:"editInsertRowBefore"},{k:"ctrl+i",f:"editInsertRowAfter"},{k:"ctrl+shift+i",f:"editInsertRowBefore"},{k:"ctrl+s",f:"editSave"},{k:"ctrl+z",f:"editUndo"},{k:"ctrl+shift+z",f:"editRedo"},{k:"ctrl+y",f:"editRedo"}],modeEdit:[{k:"up",f:"navigateUp"},{k:"down",f:"navigateDown"},{k:"enter",f:"cellEditStop"}]};a.extend(g.prototype,{init:function(){this.setup();this.bindNavigateMode();this.bindPrintableKeys();
this.bindNavigationClicks();this.bindPasteHandler();this.activate()},setup:function(){Mousetrap.prototype.stopCallback=function(c,a,b){c.preventDefault();return!1}},navigateTableCell:function(c){var a=c.parent().children().index(c);c=c.parent().parent().children().index(c.parent());!1===this.isActiveCell(c,a)&&this.navigate(c,a)},bindNavigationClicks:function(){var c=this,k=a(c.getTableBodyElement());k.on("click","td",function(){c.navigateTableCell(a(this))});k.on("dblclick","td",function(){c.navigateTableCell(a(this));
c.cellEditStart()})},bindPrintableKeys:function(){var c=a(this.getTableBodyElement());c.keypress(function(c){var a="number"===typeof c.which?c.which:c.keyCode;"keypress"===c.type&&a&&!c.ctrlKey&&console.log("KEYPRESS!")});c.focus()},bindNavigateMode:function(){Mousetrap.reset();for(var c=this,a=this.settings.modeNavigate,b={},d=0;d<a.length;b={f:b.f},d++){var e=a[d].k;b.f=a[d].f;Mousetrap.bind(e,function(a){return function(b){eval("plugin."+a.f).call(c)}}(b))}},bindPasteHandler:function(){var c=this;
a(d).on("paste",function(a){if(a.originalEvent){var b=a.originalEvent.clipboardData.getData("text");c.execute(new l(c,b));a.stopPropagation();a.preventDefault()}})},sanitizeCellIndex:function(c,a){return c>a?a:0>c?0:c},getCellRow:function(){return this._cell[0]},getCellCol:function(){return this._cell[1]},getTableBodyElement:function(){return a(this.element)[0]},getTableCell:function(){var c=this.getTableBodyElement(),a=this.getCellRow(),b=this.getCellCol();return c.rows[a].cells[b]},setCellRow:function(c){var a=
this.getTableBodyElement().rows.length-1;this._cell[0]=this.sanitizeCellIndex(c,a)},setCellCol:function(c){var a=this.getTableBodyElement(),b=this.getCellRow();this._cell[1]=this.sanitizeCellIndex(c,a.rows[b].cells.length-1)},isActiveCell:function(c,a){return this.isActiveCellRow(c)&&this.isActiveCellCol(a)},isActiveCellRow:function(a){return a===this.getCellRow()},isActiveCellCol:function(a){return a===this.getCellCol()},activate:function(){a(this.getTableCell()).addClass(this.settings.classActiveCell)},
deactivate:function(){a(this.getTableCell()).removeClass(this.settings.classActiveCell)},retrieveState:function(){return{cellRow:this.getCellRow(),cellCol:this.getCellCol(),cellVal:a(this.getTableCell()).text()}},restoreState:function(c){this._navigate(c.cellRow,c.cellCol);a(this.getTableCell()).text(c.cellVal)},getCommandExecutor:function(){return this._commandExecutor},execute:function(a){this.getCommandExecutor().execute(a)},_navigate:function(c,b){this.deactivate();this.setCellRow(c);this.setCellCol(b);
this.activate();a(this.getTableBodyElement()).focus()},navigate:function(a,b){!1!==this.getCellInput()&&this.cellEditStop();this.execute(new m(this,a,b))},navigateRow:function(a){this.navigate(this.getCellRow()+a,this.getCellCol())},navigateCol:function(a){this.navigate(this.getCellRow(),this.getCellCol()+a)},navigatePageUp:function(){this.navigateRow(-this.settings.maxPageSize)},navigatePageDown:function(){this.navigateRow(+this.settings.maxPageSize)},navigateUp:function(){this.navigateRow(-1)},
navigateDown:function(){this.navigateRow(1)},navigateLeft:function(){this.navigateCol(-1)},navigateRight:function(){this.navigateCol(1)},navigateUpSkip:function(){console.log("Navigate up skip");this.navigateRow(-1)},navigateDownSkip:function(){console.log("Navigate down skip");this.navigateRow(1)},navigateLeftSkip:function(){console.log("Navigate left skip");this.navigateCol(-1)},navigateRightSkip:function(){console.log("Navigate right skip");this.navigateCol(1)},navigateHome:function(){this.navigate(0,
0)},navigateEnd:function(){this.navigate(1E3,1E3)},navigateRowHome:function(){this.navigateCol(-1E3)},navigateRowEnd:function(){this.navigateCol(1E3)},navigateSheetFore:function(){console.log("Navigate forward")},navigateSheetAnte:function(){console.log("Navigate backward")},cellCut:function(){this.execute(new n(this))},cellCopy:function(){var c=a("<input>");a("body").append(c);c.val(a(this.getTableCell()).text()).select();d.execCommand("copy");c.remove()},cellErase:function(){this.execute(new l(this,
""))},cellInputCreate:function(c){c.addClass(this.settings.classActiveCellInput);var b=c.width();c=c.text();var d=a("<input>");d.prop({type:"text",value:c});d.css({width:b,"max-width":b});return d},cellInputDestroy:function(){var a=this.getCellInput(),b=a.val();a.remove();this.setCellInput(!1);return b},getCellInput:function(){return this._$cellInput},setCellInput:function(a){this._$cellInput=a},cellEditStart:function(){this.execute(new p(this))},cellEditStop:function(){var c=a(this.getTableBodyElement()),
b=this.cellInputDestroy(),d=a(this.getTableCell());d.removeClass(this.settings.classActiveCellInput);d.text(b);c.focus()},cellEditCancel:function(){console.log("Edit cancel");this.cellEditStop()},editSave:function(){console.log("Save cells");this.cellEditStop()},editInsertRowBefore:function(){console.log("Insert row before")},editInsertRowAfter:function(){console.log("Insert row after")},editUndo:function(){this.getCommandExecutor().undo()},editRedo:function(){this.getCommandExecutor().redo()}});
a.fn.ivy=function(c){return this.each(function(){if(!a.data(this,"plugin_ivy")){var b=new g(this,c);a.data(this,"plugin_ivy",b)}})};var h=function(){this._undoStack=[];this._redoStack=[]};h.prototype.getUndoStack=function(){return this._undoStack};h.prototype.getRedoStack=function(){return this._redoStack};h.prototype.execute=function(a){a.execute();var c=this.getUndoStack(),b=c.peek();a.equals(b)||c.push(a)};h.prototype.undo=function(){var a=this.getUndoStack().pop();"undefined"!==typeof a&&(a.undo(),
this.getRedoStack().push(a))};h.prototype.redo=function(){var a=this.getRedoStack().pop();"undefined"!==typeof a&&this.execute(a)};var f=function(a){this._plugin=a;this._state=a.retrieveState()};f.prototype.execute=function(){};f.prototype.equals=function(a){var c=!1;"undefined"!==typeof a&&(c=Object.equals(this,a));return c};f.prototype.undo=function(){this.getPlugin().restoreState(this.getState())};f.prototype.getState=function(){return this._state};f.prototype.getPlugin=function(){return this._plugin};
var m=function(a,b,d){a=f.call(this,a)||this;a._row=b;a._col=d;return a};$jscomp.inherits(m,f);m.prototype.execute=function(){this.getPlugin()._navigate(this._row,this._col)};var n=function(a){return f.call(this,a)||this};$jscomp.inherits(n,f);n.prototype.execute=function(){var a=this.getPlugin();a.cellCopy();a.cellErase()};var p=function(a,b){return f.call(this,a)||this};$jscomp.inherits(p,f);p.prototype.execute=function(){var c=this.getPlugin(),b=a(c.getTableCell()),d=c.cellInputCreate(b);c.setCellInput(d);
d.on("focusout",function(){b.text(d.val())});b.html(d);d.focus()};var l=function(a,b){a=f.call(this,a)||this;a._cellValue=b;return a};$jscomp.inherits(l,f);l.prototype.execute=function(){var b=this.getPlugin();a(b.getTableCell()).text(this._cellValue)};b.Plugin=g})(jQuery,window,document);Array.prototype.peek=function(){return this[this.length-1]};
Object.equals=function(a,b){if(null===a||void 0===a||null===b||void 0===b)return a===b;if(a===b||a.valueOf()===b.valueOf())return!0;if(!(a instanceof Object&&b instanceof Object))return!1;var d=Object.keys(a);return Object.keys(b).every(function(a){return-1!==d.indexOf(a)})&&d.every(function(d){return Object.equals(a[d],b[d])})};
