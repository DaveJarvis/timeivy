var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(b){var c=function(){};c.prototype=b;return new c};$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},c={};try{return c.__proto__=b,c.a}catch(e){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null;
$jscomp.inherits=function(b,c){b.prototype=$jscomp.objectCreate(c.prototype);b.prototype.constructor=b;if($jscomp.setPrototypeOf){var e=$jscomp.setPrototypeOf;e(b,c)}else for(e in c)if("prototype"!=e)if(Object.defineProperties){var l=Object.getOwnPropertyDescriptor(c,e);l&&Object.defineProperty(b,e,l)}else b[e]=c[e];b.superClass_=c.prototype};
(function(b,c,e,l){function m(a,d){this.element=a;this.settings=b.extend({},r,d);this._defaults=r;this._name="ivy";this._cell=[0,0];this._$cellInput=!1;this._commandExecutor=new g;this.init()}var r={classActiveCell:"active",classActiveCellInput:"edit",classCellReadOnly:"readonly",maxPageSize:30,maxUndoLevels:1E3,dispatchKeysNavigate:[{k:"enter",f:"navigateDown"},{k:"up",f:"navigateUp"},{k:"down",f:"navigateDown"},{k:"left",f:"navigateLeft"},{k:"right",f:"navigateRight"},{k:"ctrl+up",f:"navigateUpSkip"},
{k:"ctrl+down",f:"navigateDownSkip"},{k:"ctrl+left",f:"navigateLeftSkip"},{k:"ctrl+right",f:"navigateRightSkip"},{k:"pageup",f:"navigatePageUp"},{k:"pagedown",f:"navigatePageDown"},{k:"home",f:"navigateRowHome"},{k:"end",f:"navigateRowEnd"},{k:"ctrl+home",f:"navigateHome"},{k:"ctrl+end",f:"navigateEnd"},{k:"shift+tab",f:"navigateLeft"},{k:"tab",f:"navigateRight"},{k:"ctrl+x",f:"cellCut"},{k:"ctrl+c",f:"cellCopy"},{k:"ctrl+ins",f:"cellCopy"},{k:"del",f:"cellErase"},{k:"f2",f:"cellEditStart"},{k:"ins",
f:"editInsertRow"},{k:"ctrl+i",f:"editInsertRow"},{k:"command+i",f:"editInsertRow"},{k:"ctrl+s",f:"editSave"},{k:"ctrl+z",f:"editUndo"},{k:"command+z",f:"editUndo"},{k:"ctrl+shift+z",f:"editRedo"},{k:"ctrl+y",f:"editRedo"},{k:"command+y",f:"editRedo"}],dispatchKeysEdit:[{k:"up",f:"navigateUp"},{k:"down",f:"navigateDown"},{k:"shift+tab",f:"navigateLeft"},{k:"tab",f:"navigateRight"},{k:"enter",f:"cellEditStop"},{k:"esc",f:"cellEditCancel"}],onCellValueChange:function(a,d,b){return a}};b.extend(m.prototype,
{init:function(){this.setup();this.bindNavigateMode();this.bindPrintableKeys();this.bindNavigationClicks();this.bindPasteHandler();this.activate()},setup:function(){Mousetrap.prototype.stopCallback=function(a,d,b){a.preventDefault();return!1}},navigateTableCell:function(a){var d=a.parent().children().index(a);a=a.parent().parent().children().index(a.parent());!1===this.isActiveCell(a,d)&&this.navigate(a,d)},bindNavigationClicks:function(){var a=this,d=b(a.getTableBodyElement());d.on("click","td",
function(){a.navigateTableCell(b(this))});d.on("dblclick","td",function(){a.navigateTableCell(b(this));a.cellEditStart(!1)})},bindPrintableKeys:function(){var a=this;b(a.getTableBodyElement()).on("keypress",function(d){var b="number"===typeof d.which?d.which:d.keyCode;"keypress"!==d.type||!b||d.ctrlKey||d.metaKey||a.cellEditStart(!0)})},unbindPrintableKeys:function(){b(this.getTableBodyElement()).off("keypress")},_bindDispatchKeys:function(a){Mousetrap.reset();for(var d=this,b={},c=0;c<a.length;b=
{f:b.f},c++){var e=a[c].k;b.f=a[c].f;Mousetrap.bind(e,function(a){return function(b){d[a.f]()}}(b))}},bindNavigateMode:function(){this._bindDispatchKeys(this.settings.dispatchKeysNavigate)},bindEditMode:function(){this._bindDispatchKeys(this.settings.dispatchKeysEdit)},bindPasteHandler:function(){var a=this;b(e).on("paste",function(d){if(d.originalEvent){var b=d.originalEvent.clipboardData.getData("text");a.execute(new k(a,b));d.stopPropagation();d.preventDefault()}})},sanitizeCellIndex:function(a,
d){return a>d?d:0>a?0:a},getCellRow:function(){return this._cell[0]},getCellCol:function(){return this._cell[1]},getTableBodyElement:function(){return b(this.element)[0]},getTableCell:function(){var a=this.getTableBodyElement(),d=this.getCellRow(),b=this.getCellCol();return a.rows[d].cells[b]},setCellRow:function(a){var b=this.getTableBodyElement().rows.length-1;this._cell[0]=this.sanitizeCellIndex(a,b)},setCellCol:function(a){var b=this.getTableBodyElement(),c=this.getCellRow();this._cell[1]=this.sanitizeCellIndex(a,
b.rows[c].cells.length-1)},isActiveCell:function(a,b){return this.isActiveCellRow(a)&&this.isActiveCellCol(b)},isActiveCellRow:function(a){return a===this.getCellRow()},isActiveCellCol:function(a){return a===this.getCellCol()},isActiveCellReadOnly:function(){return b(this.getTableCell()).hasClass(this.settings.classCellReadOnly)},activate:function(){b(this.getTableCell()).addClass(this.settings.classActiveCell)},deactivate:function(){b(this.getTableCell()).removeClass(this.settings.classActiveCell)},
cellStateRetrieve:function(){return{cellRow:this.getCellRow(),cellCol:this.getCellCol(),cellValue:b(this.getTableCell()).text()}},cellStateRestore:function(a){this._navigate(a.cellRow,a.cellCol);this.setCellValue(a.cellValue)},getCommandExecutor:function(){return this._commandExecutor},execute:function(a){this.getCommandExecutor().execute(a)},focus:function(){b(this.getTableBodyElement()).focus()},_navigate:function(a,b){this.deactivate();this.setCellRow(a);this.setCellCol(b);this.activate();this.focus()},
navigate:function(a,b){this.cellEditStop();this.execute(new n(this,a,b))},navigateRow:function(a){this.navigate(this.getCellRow()+a,this.getCellCol())},navigateCol:function(a){this.navigate(this.getCellRow(),this.getCellCol()+a)},navigatePageUp:function(){this.navigateRow(-this.settings.maxPageSize)},navigatePageDown:function(){this.navigateRow(+this.settings.maxPageSize)},navigateUp:function(){this.navigateRow(-1)},navigateDown:function(){this.navigateRow(1)},navigateLeft:function(){this.navigateCol(-1)},
navigateRight:function(){this.navigateCol(1)},navigateUpSkip:function(){console.log("Navigate up skip");this.navigateRow(-1)},navigateDownSkip:function(){console.log("Navigate down skip");this.navigateRow(1)},navigateLeftSkip:function(){console.log("Navigate left skip");this.navigateCol(-1)},navigateRightSkip:function(){console.log("Navigate right skip");this.navigateCol(1)},navigateHome:function(){this.navigate(0,0)},navigateEnd:function(){this.navigate(1E3,1E3)},navigateRowHome:function(){this.navigateCol(-1E3)},
navigateRowEnd:function(){this.navigateCol(1E3)},cellCut:function(){this.execute(new p(this))},cellCopy:function(){var a=b("<input>");b("body").append(a);a.val(b(this.getTableCell()).text()).select();e.execCommand("copy");a.remove()},cellErase:function(){this.execute(new k(this,""))},cellInputCreate:function(a){a.addClass(this.settings.classActiveCellInput);var d=a.width();a=a.text();var c=b("<input>");c.prop({type:"text",value:a});c.css({width:d,"max-width":d});return c},cellInputDestroy:function(){var a=
this.getCellInput(),b=a.val();a.remove();this.setCellInput(!1);return b},getCellInput:function(){return this._$cellInput},setCellInput:function(a){this._$cellInput=a},cellEditStart:function(a){this.isActiveCellReadOnly()||this.execute(new q(this,a))},cellEditStop:function(){var a=!1;if(!1!==this.getCellInput()){a=this.cellInputDestroy();b(this.getTableCell()).removeClass(this.settings.classActiveCellInput);var d=this.getCellRow(),c=this.getCellCol();a=this.settings.onCellValueChange(a,d,c);this.setCellValue(a);
this.focus();this.bindNavigateMode();this.bindPrintableKeys();a=!0}return a},setCellValue:function(a){b(this.getTableCell()).text(a)},cellEditCancel:function(){this.cellEditStop()&&this.editUndo()},editSave:function(){console.log("Save cells")},editInsertRow:function(){this.execute(new h(this))},editUndo:function(){this.getCommandExecutor().undo()},editRedo:function(){this.getCommandExecutor().redo()}});b.fn.ivy=function(a){return this.each(function(){if(!b.data(this,"plugin_ivy")){var d=new m(this,
a);b.data(this,"plugin_ivy",d)}})};var g=function(){this._undoStack=[];this._redoStack=[]};g.prototype.getUndoStack=function(){return this._undoStack};g.prototype.getRedoStack=function(){return this._redoStack};g.prototype.execute=function(a){a.execute();var b=this.getUndoStack(),c=b.peek();a.equals(c)||b.push(a)};g.prototype.undo=function(){var a=this.getUndoStack().pop();"undefined"!==typeof a&&(a.undo(),this.getRedoStack().push(a))};g.prototype.redo=function(){var a=this.getRedoStack().pop();"undefined"!==
typeof a&&this.execute(a)};var f=function(a){this._plugin=a;this.saveState()};f.prototype.execute=function(){};f.prototype.equals=function(a){return"undefined"===typeof a?!1:Object.equals(this.getState(),a.getState())};f.prototype.undo=function(){this.getPlugin().cellStateRestore(this.getState())};f.prototype.saveState=function(){this.setState(this.getPlugin().cellStateRetrieve())};f.prototype.setState=function(a){this._state=a};f.prototype.getState=function(){return this._state};f.prototype.getPlugin=
function(){return this._plugin};var n=function(a,b,c){a=f.call(this,a)||this;a._row=b;a._col=c;return a};$jscomp.inherits(n,f);n.prototype.execute=function(){this.getPlugin()._navigate(this._row,this._col)};var p=function(a){return f.call(this,a)||this};$jscomp.inherits(p,f);p.prototype.execute=function(){var a=this.getPlugin();a.cellCopy();a.cellErase()};var q=function(a,b){var d=f.call(this,a)||this;b&&a.setCellValue("");return d};$jscomp.inherits(q,f);q.prototype.execute=function(){var a=this.getPlugin();
a.bindEditMode();a.unbindPrintableKeys();var d=b(a.getTableCell()),c=a.cellInputCreate(d);a.setCellInput(c);c.on("focusout",function(){a.cellEditStop()});d.html(c);c.focus()};var k=function(a,b){a=f.call(this,a)||this;a._cellValue=b;return a};$jscomp.inherits(k,f);k.prototype.execute=function(){this.getPlugin().setCellValue(this._cellValue)};var h=function(a){return f.call(this,a)||this};$jscomp.inherits(h,f);h.prototype.execute=function(){var a=this.getPlugin();a.deactivate();var c=b(a.getTableCell()).closest("tr"),
e=c.clone();this.setState({id:this.getId(),clone:e});c.after(e);a.activate()};h.prototype.undo=function(){this.getState().clone.remove()};h.prototype.getId=function(){return(new Date).getTime()+Math.random()};c.Plugin=m})(jQuery,window,document);Array.prototype.peek=function(){return this[this.length-1]};
Object.equals=function(b,c){if(!(b instanceof Object&&c instanceof Object))return!1;for(var e in b)if(b.hasOwnProperty(e)&&(!c.hasOwnProperty(e)||b[e]!==c[e]&&!Object.equals(b[e],c[e])))return!1;return!0};
