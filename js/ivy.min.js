var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(a){var d=function(){};d.prototype=a;return new d};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},d={};try{return d.__proto__=a,d.a}catch(c){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,d){a.__proto__=d;if(a.__proto__!==d)throw new TypeError(a+" is not extensible");return a}:null;
$jscomp.inherits=function(a,d){a.prototype=$jscomp.objectCreate(d.prototype);a.prototype.constructor=a;if($jscomp.setPrototypeOf){var c=$jscomp.setPrototypeOf;c(a,d)}else for(c in d)if("prototype"!=c)if(Object.defineProperties){var b=Object.getOwnPropertyDescriptor(d,c);b&&Object.defineProperty(a,c,b)}else a[c]=d[c];a.superClass_=d.prototype};
$jscomp.findInternal=function(a,d,c){a instanceof String&&(a=String(a));for(var b=a.length,f=0;f<b;f++){var h=a[f];if(d.call(c,h,f,a))return{i:f,v:h}}return{i:-1,v:void 0}};$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,c,b){if(d){c=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var f=a[b];f in c||(c[f]={});c=c[f]}a=a[a.length-1];b=c[a];d=d(b);d!=b&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");
$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var f=b.length;for(c=c||0;c<f;c++)if(b[c]==a||Object.is(b[c],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,d,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(d instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
Array.prototype.peek=function(){return this[this.length-1]};Date.prototype.isWeekend=function(){var a=this.getDay();return 0==a||6==a};String.prototype.padLeft=function(a){return String(a+this).slice(-a.length)};
String.prototype.toTime=function(){var a=this,d=!1,c=!1,b=0,f=0;null!=a?(d=null!==a.match(/p/i),c=null!==a.match(/a/i),a=a.replace(/^00/,"24"),a=parseInt(a.replace(/\D/g,""),10)):a=0;0<a&&24>a?b=a:100<=a&&2359>=a?(b=~~(a/100),f=a%100):2400<=a&&(f=a%100,d=!1);12==b&&!1===c?d=!0:12<b&&(d=!0,b-=12);59<f&&(f=59);return(""+b).padLeft("00")+":"+(""+f).padLeft("00")+" "+(d?"PM":"AM")};
Object.equals=function(a,d){if(!(a instanceof Object&&d instanceof Object))return!1;for(var c in a)if(a.hasOwnProperty(c)&&(!d.hasOwnProperty(c)||a[c]!==d[c]&&!Object.equals(a[c],d[c])))return!1;return!0};Storage.prototype.put=function(a,d){this.setItem(a,CJSON.stringify(d))};Storage.prototype.get=function(a,d){a=this.getItem(a);return null===a?d:CJSON.parse(a)};(function(a,d,c,b){function f(e,b){this.element=e;this.settings=a.extend({},h,b);this.settings.ivy=this;this._defaults=h;this._name="ivy";this._cell=[0,0];this._$cellInput=!1;this._commandExecutor=new k;this.init()}var h={classActiveCell:"active",classActiveCellInput:"edit",classCellReadOnly:"readonly",maxPageSize:30,dispatchKeysNavigate:[{k:"enter",f:"navigateDown"},{k:"up",f:"navigateUp"},{k:"down",f:"navigateDown"},{k:"left",f:"navigateLeft"},{k:"right",f:"navigateRight"},{k:"ctrl+up",f:"navigateUpSkip"},
{k:"ctrl+down",f:"navigateDownSkip"},{k:"ctrl+left",f:"navigateLeftSkip"},{k:"ctrl+right",f:"navigateRightSkip"},{k:"pageup",f:"navigatePageUp"},{k:"pagedown",f:"navigatePageDown"},{k:"home",f:"navigateRowHome"},{k:"end",f:"navigateRowEnd"},{k:"ctrl+home",f:"navigateHome"},{k:"ctrl+end",f:"navigateEnd"},{k:"shift+tab",f:"navigateLeft"},{k:"tab",f:"navigateRight"},{k:"f2",f:"editStart"},{k:"ctrl+x",f:"editCut"},{k:"ctrl+c",f:"editCopy"},{k:"ctrl+ins",f:"editCopy"},{k:"del",f:"editErase"},{k:"shift+del",
f:"editDeleteRow"},{k:"ins",f:"editInsertRow"},{k:"ctrl+i",f:"editInsertRow"},{k:"command+i",f:"editInsertRow"},{k:"shift+space",f:"editAppendRow"},{k:"ctrl+z",f:"editUndo"},{k:"command+z",f:"editUndo"},{k:"ctrl+shift+z",f:"editRedo"},{k:"ctrl+y",f:"editRedo"},{k:"command+y",f:"editRedo"}],dispatchKeysEdit:[{k:"up",f:"navigateUp"},{k:"down",f:"navigateDown"},{k:"shift+tab",f:"navigateLeft"},{k:"tab",f:"navigateRight"},{k:"enter",f:"editStop"},{k:"esc",f:"editCancel"}],init:function(){},refreshCells:function(){},
onCellValueChangeBefore:function(e,a,b){return e},onCellValueChangeAfter:function(e,a){},onRowInsertAfter:function(e,a){},onRowAppendAfter:function(e,a){},onRowDeleteAfter:function(e){}};a.extend(f.prototype,{init:function(){this.settings.init();this.refreshCells();this.setup();this.bindNavigateMode();this.bindPrintableKeys();this.bindNavigationClicks();this.bindPasteHandler();this.activate()},refreshCells:function(){this.settings.refreshCells()},setup:function(){Mousetrap.prototype.stopCallback=
function(e,a,b){e.preventDefault();return!1}},navigateTableCell:function(e){var a=e.parent().children().index(e);e=e.parent().parent().children().index(e.parent());!1===this.isActiveCell(e,a)&&this.navigate(e,a)},bindNavigationClicks:function(){var e=this,b=a(e.getTableBodyElement());b.on("click","td",function(){e.navigateTableCell(a(this))});b.on("dblclick doubletap","td",function(){e.navigateTableCell(a(this));e.editStart()})},bindPrintableKeys:function(){var e=this;a(e.getTableBodyElement()).on("keypress",
function(a){var b="number"===typeof a.which?a.which:a.keyCode;"keypress"!==a.type||!b||a.ctrlKey||a.metaKey||(e.editStart(String.fromCharCode(b)),a.stopPropagation(),a.preventDefault())})},unbindPrintableKeys:function(){a(this.getTableBodyElement()).off("keypress")},_bindDispatchKeys:function(e){Mousetrap.reset();for(var a=this,b={},c=0;c<e.length;b={f:b.f},c++){var f=e[c].k;b.f=e[c].f;Mousetrap.bind(f,function(e){return function(b){a[e.f]()}}(b))}},bindNavigateMode:function(){this._bindDispatchKeys(this.settings.dispatchKeysNavigate)},
bindEditMode:function(){this._bindDispatchKeys(this.settings.dispatchKeysEdit)},bindPasteHandler:function(){var e=this;a(c).on("paste",function(a){if(a.originalEvent){var b=a.originalEvent.clipboardData.getData("text");e.cellUpdate(b);a.stopPropagation();a.preventDefault()}})},_sanitizeCellIndex:function(e,a){return e>a?a:0>e?0:e},getTableBodyElement:function(){return a(this.element)[0]},getCellRow:function(){return this._cell[0]},getCellCol:function(){return this._cell[1]},setCellRow:function(e){this._cell[0]=
this._sanitizeCellIndex(e,this.getMaxRows())},setCellCol:function(e){this._cell[1]=this._sanitizeCellIndex(e,this.getMaxCols())},getCell:function(e,a){return this.getTableBodyElement().rows[e].cells[a]},getCellLastRow:function(a){var e=this.getMaxRows();return this.getCell(e,a)},getActiveCell:function(){var a=this.getCellRow(),b=this.getCellCol();return this.getCell(a,b)},getMaxRows:function(){return this.getTableBodyElement().rows.length-1},getMaxCols:function(){return this.getTableBodyElement().rows[0].cells.length-
1},isActiveCell:function(a,b){return this.isActiveCellRow(a)&&this.isActiveCellCol(b)},isActiveCellRow:function(a){return a===this.getCellRow()},isActiveCellCol:function(a){return a===this.getCellCol()},isActiveCellReadOnly:function(){return a(this.getActiveCell()).hasClass(this.settings.classCellReadOnly)},activate:function(){this.setCellRow(this.getCellRow());this.setCellCol(this.getCellCol());a(this.getActiveCell()).addClass(this.settings.classActiveCell)},deactivate:function(){a(this.getActiveCell()).removeClass(this.settings.classActiveCell)},
cellStateRetrieve:function(){var e=a(this.getActiveCell());return{cellRow:this.getCellRow(),cellCol:this.getCellCol(),cellValue:e.text()}},cellStateRestore:function(a){this._navigate(a.cellRow,a.cellCol);this.setActiveCellValue(a.cellValue)},getCommandExecutor:function(){return this._commandExecutor},execute:function(a){this.getCommandExecutor().execute(a)},focus:function(){a(this.getTableBodyElement()).focus()},_navigate:function(a,b){this.deactivate();this.setCellRow(a);this.setCellCol(b);this.activate();
this.focus()},navigate:function(a,b){this.editStop();this.execute(new n(this,a,b))},navigateRow:function(a){this.navigate(this.getCellRow()+a,this.getCellCol())},navigateCol:function(a){this.navigate(this.getCellRow(),this.getCellCol()+a)},navigatePageUp:function(){this.navigateRow(-this.settings.maxPageSize)},navigatePageDown:function(){this.navigateRow(+this.settings.maxPageSize)},navigateUp:function(){this.navigateRow(-1)},navigateDown:function(){this.navigateRow(1)},navigateLeft:function(){this.navigateCol(-1)},
navigateRight:function(){this.navigateCol(1)},navigateUpSkip:function(){console.log("Navigate up skip");this.navigateRow(-1)},navigateDownSkip:function(){console.log("Navigate down skip");this.navigateRow(1)},navigateLeftSkip:function(){console.log("Navigate left skip");this.navigateCol(-1)},navigateRightSkip:function(){console.log("Navigate right skip");this.navigateCol(1)},navigateHome:function(){this.navigate(0,0)},navigateEnd:function(){this.navigate(1E3,1E3)},navigateRowHome:function(){this.navigateCol(-1E3)},
navigateRowEnd:function(){this.navigateCol(1E3)},editCut:function(){this.execute(new m(this))},editCopy:function(){var e=a("<input>"),b=a(this.getActiveCell());a("body").append(e);e.val(b.text()).select();c.execCommand("copy");e.remove()},editErase:function(){this.cellUpdate("")},cellUpdate:function(a){this.isActiveCellReadOnly()||this.execute(new q(this,a))},cellInputCreate:function(e,b){e.addClass(this.settings.classActiveCellInput);var c=e.width();e=b?b:e.text();b=a("<input>");b.css({width:c,"max-width":c});
b.val(e);return b},cellInputDestroy:function(){var a=this.getCellInput(),b=a.val();a.remove();this.setCellInput(!1);return b},getCellInput:function(){return this._$cellInput},setCellInput:function(a){this._$cellInput=a},editStart:function(a){this.isActiveCellReadOnly()||this.execute(new l(this,a))},editStop:function(){var e=!1;!1!==this.getCellInput()&&(e=this.cellInputDestroy(),a(this.getActiveCell()).removeClass(this.settings.classActiveCellInput),this.setActiveCellValue(e),this.focus(),this.bindNavigateMode(),
this.bindPrintableKeys(),e=!0);return e},setCellValue:function(e,b,c){e=this.settings.onCellValueChangeBefore(e,b,c);a(this.getCell(b,c)).text(e);this.settings.onCellValueChangeAfter(b,c)},setActiveCellValue:function(a){var b=this.getCellRow(),e=this.getCellCol();this.setCellValue(a,b,e)},setActiveCellValueSilent:function(b){console.log("setActiveCellValueSilent "+b);if(!1!==b){var e=this.getActiveCell();a(e).text(b)}},editCancel:function(){this.editStop()&&this.editUndo()},editInsertColumn:function(a){this.execute(new u(this,
a))},editDeleteColumn:function(a){this.execute(new CommandDeleteColumn(this,a))},editInsertRow:function(){this.execute(new p(this))},editDeleteRow:function(){0<this.getMaxRows()&&this.execute(new r(this))},editAppendRow:function(){this.execute(new t(this))},editUndo:function(){this.getCommandExecutor().undo();this.refreshCells()},editRedo:function(){this.getCommandExecutor().redo()},onRowInsertAfter:function(a,b){this.settings.onRowInsertAfter(a,b)},onRowAppendAfter:function(a,b){this.settings.onRowAppendAfter(a,
b)},onRowDeleteAfter:function(a){this.settings.onRowDeleteAfter(a)}});var k=function(){this._undoStack=[];this._redoStack=[]};k.prototype.getUndoStack=function(){return this._undoStack};k.prototype.getRedoStack=function(){return this._redoStack};k.prototype.execute=function(a){a.execute();var b=this.getUndoStack(),e=b.peek();a.equals(e)||b.push(a)};k.prototype.undo=function(){var a=this.getUndoStack().pop();"undefined"!==typeof a&&(a.undo(),this.getRedoStack().push(a))};k.prototype.redo=function(){var a=
this.getRedoStack().pop();"undefined"!==typeof a&&this.execute(a)};var g=function(a){this._plugin=a;this.saveState()};g.prototype.execute=function(){};g.prototype.equals=function(a){return"undefined"===typeof a?!1:Object.equals(this.getState(),a.getState())};g.prototype.undo=function(){this.getPlugin().cellStateRestore(this.getState())};g.prototype.getId=function(){return(new Date).getTime()};g.prototype.saveState=function(){this.setState(this.getPlugin().cellStateRetrieve())};g.prototype.setState=
function(a){this._state=a};g.prototype.getState=function(){return this._state};g.prototype.getPlugin=function(){return this._plugin};var n=function(a,b,c){a=g.call(this,a)||this;a._row=b;a._col=c;return a};$jscomp.inherits(n,g);n.prototype.execute=function(){this.getPlugin()._navigate(this._row,this._col)};var m=function(a){return g.call(this,a)||this};$jscomp.inherits(m,g);m.prototype.execute=function(){var a=this.getPlugin();a.editCopy();a.editErase()};var l=function(a,b){a=g.call(this,a)||this;
a._charCode=b;return a};$jscomp.inherits(l,g);l.prototype.execute=function(){var b=this.getPlugin();b.bindEditMode();b.unbindPrintableKeys();var c=a(b.getActiveCell()),f=b.cellInputCreate(c,this._charCode);b.setCellInput(f);c.html(f);f.focus();f.on("focusout",function(){b.editStop()})};var q=function(a,b){a=g.call(this,a)||this;a._cellValue=b;return a};$jscomp.inherits(q,g);q.prototype.execute=function(){this.getPlugin().setActiveCellValue(this._cellValue)};var u=function(a,b){a=g.call(this,a)||this;
a._columnName=b;return a};$jscomp.inherits(u,g);u.prototype.execute=function(){var b=this.getPlugin();b.deactivate();a(b.getTableBodyElement()).parent().find("thead");b.activate()};var p=function(a){return g.call(this,a)||this};$jscomp.inherits(p,g);p.prototype.execute=function(){var a=this.getPlugin();a.deactivate();var b=this.getRow().clone();this.setState({id:this.getId(),clone:b});this.inject(b);a.activate()};p.prototype.inject=function(a){var b=this.getRow();b.after(a);this.getPlugin().onRowInsertAfter(b,
a)};p.prototype.undo=function(){this.getState().clone.remove()};p.prototype.getRow=function(){return a(this.getPlugin().getActiveCell()).closest("tr")};var t=function(a){return p.call(this,a)||this};$jscomp.inherits(t,p);t.prototype.inject=function(a){var b=this.getRow();b.after(a);this.getPlugin().onRowAppendAfter(b,a)};t.prototype.getRow=function(){return a(this.getPlugin().getTableBodyElement()).find("tr:last")};var r=function(a){return g.call(this,a)||this};$jscomp.inherits(r,g);r.prototype.execute=
function(){var b=this.getPlugin();b.deactivate();var c=a(b.getActiveCell()).closest("tr");this.setState({id:this.getId(),row:c});c.remove();b.onRowDeleteAfter(c);b.activate()};r.prototype.undo=function(){this.getPlugin().editInsertRow()};a.fn.ivy=function(b){var c;this.each(function(){a.data(this,"plugin_ivy")||(c=new f(this,b),a.data(this,"plugin_ivy",c))});return c};d.Plugin=f})(jQuery,window,document);$(document).ready(function(){var a={description:"Controls for application behaviour.",title:"Preferences",type:"object",properties:{weekdays:{description:"Rows added when inserting new days.",type:"array",title:"Weekdays",format:"table",uniqueItems:!0,items:{type:"object",required:"weekday",properties:{weekday:{title:"Weekday",type:"string","enum":[0,1,2,3,4,5,6],options:{enum_titles:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")}},times:{title:"Times",type:"array",format:"table",
items:{type:"object",properties:{began:{type:"string",title:"Began","default":"08:00 AM"},ended:{type:"string",title:"Ended","default":"04:00 PM"}}}}}}},formats:{description:"Timesheet display formats, change with caution.",title:"Format",type:"object",properties:{format_time:{type:"string",title:"Time","default":"HH:mm A"},format_date:{type:"string",title:"Date","default":"YYYY-MMM-DD"},format_prec:{type:"integer",title:"Precision","default":2}}},inclusion:{description:"Include these upon day insertion.",
type:"object",title:"Include",properties:{weekends:{type:"boolean",title:"Weekends",format:"checkbox","default":!1},holidays:{type:"boolean",title:"Holidays",format:"checkbox","default":!1}}},columns:{description:"Extra columns to help organize data.",type:"array",title:"Columns",format:"tabs",maxItems:3,items:{type:"string",title:"Column"}}}},d=$("#ivy tbody").ivy({getDefaults:function(){return{formats:{format_time:"hh:mm A",format_date:"YYYY-MM-DD",format_prec:2},weekdays:[{weekday:1,times:[{began:"745",
ended:"930"},{began:"930",ended:"1000"},{began:"1000",ended:"345p"}]}],inclusion:{weekends:!1,holidays:!1},columns:["Description"]}},getPreferences:function(){return localStorage.get("ivy.preferences",this.getDefaults())},setPreferences:function(a){localStorage.put("ivy.preferences",a)},init:function(){this.initMenu();this.initHeadings();this.initTimesheet();this.initPreferencesDialog();this.initPreferencesEditor()},initMenu:function(){for(var a=this.ivy,b=[{a:"edit-cut",f:"Cut"},{a:"edit-copy",f:"Copy"},
{a:"edit-undo",f:"Undo"},{a:"edit-redo",f:"Redo"},{a:"insert-shift",f:"InsertRow"},{a:"delete-row",f:"DeleteRow"},{a:"append-day",f:"AppendRow"},{a:"append-days",f:"AppendMonth"}],f=b.length,h={i:0};h.i<f;h={i:h.i},h.i++)$(".app-"+b[h.i].a).on("click",function(a){return function(c){d["edit"+b[a.i].f]()}}(h));$(".ivy-export-csv").exportable({source:a.element,filename:"timesheet.csv"});$(".ivy-export-json").exportable({source:a.element,filename:"timesheet.json"})},initHeadings:function(){for(var a=
$(this.ivy.getTableBodyElement()).prev("thead").find("tr:first"),b=this.getPreferences().columns,f=b.length,h="",k=0;k<f;k++)h+="<th>"+b[k]+"</th>";a.append(h)},initTimesheet:function(){var a=this,b=a.ivy,f=a.getPreferences(),h=b.settings.classCellReadOnly;b=$(b.getTableBodyElement());var k=b.prev("thead").find("tr:first > th"),g="<tr>",d=f.formats.format_date;k.each(function(b){g+="<td";[0,3,4].includes(b)?(g+=" class='"+h+"'>",0===b&&(b=moment().startOf("month").subtract(1,"day"),b=a.getNextWorkDay(b),
g+=b.format(d))):g+=">";g+="</td>"});g+="</tr>";b.append(g)},initPreferencesDialog:function(){$("#settings").dialog({dialogClass:"settings-dialog",autoOpen:!1,maxHeight:.75*$(window).height(),height:"auto",width:"auto",closeOnEscape:!0,position:{my:"right top",at:"right top",of:window},buttons:{Ok:function(){$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}}});$(".app-settings-preferences").on("click",function(a){$("#settings").dialog("open")})},initPreferencesEditor:function(){var c=
document.getElementById("editor");new JSONEditor(c,{theme:"jqueryui",disable_collapse:!0,disable_edit_json:!0,disable_properties:!0,disable_array_reorder:!0,disable_array_delete_all_rows:!0,disable_array_delete_last_row:!0,required_by_default:!0,no_additional_properties:!0,remove_empty_properties:!0,schema:a,startval:this.getPreferences()})},getNextWorkDay:function(a){var b=this.getPreferences();a=a.clone();do a.add(1,"day");while(!b.inclusion.weekends&&a.toDate().isWeekend());return a},refreshCells:function(){for(var a=
this.ivy.getMaxRows(),b=0;b<=a;b++)this.onCellValueChangeAfter(b,1)},onCellValueChangeBefore:function(a,b,f){if(1===f||2===f)a=a.toTime();return a},onCellValueChangeAfter:function(a,b){if(1===b||2===b){b=this.ivy;var c=this.getPreferences(),h=this.updateCellTime(a,1),k=this.updateCellTime(a,2,h,60);h=moment.duration(k.diff(h)).asHours();h.toFixed&&(h=Math.abs(h).toFixed(c.formats.format_prec));$(b.getCell(a,3)).text(h);a=this.findConsecutive(a,0);c=this.sumConsecutive(a);$(b.getCell(a[0],4)).text(c)}},
onRowInsertAfter:function(a,b){a=this.ivy;var c=b.find("td:eq(2)").text();b.find("td:not(:first-child)").empty();b=b.index();a.setCellValue(c,b,1);a.refreshCells()},onRowAppendAfter:function(a,b){var c=this.ivy;b=b.find("td:first");var h=moment(b.text()),k=h.month();h=this.getNextWorkDay(h);var g=h.month();k===g?(a=this.getPreferences(),b.text(h.format(a.formats.format_date))):a.remove();c.refreshCells()},updateCellTime:function(a,b,f,h){var c=this.ivy,g=this.getPreferences();a=$(c.getCell(a,b));
b=a.text();""==b&&(b=moment(f).add(h,"minutes"),b=b.format(g.formats.format_time),a.text(b));return moment.utc(b,g.formats.format_time)},findConsecutive:function(a,b){for(var c=this.ivy,h=a,k=$(c.getCell(a,b)).text(),g=k;k==g&&0<=--h;)g=$(c.getCell(h,b)).text();var d=h+1,m=c.getMaxRows();h=a;for(g=k;k==g&&++h<m;)g=$(c.getCell(h,b)).text();return[d,h-1]},sumConsecutive:function(a){for(var b=this.ivy,c=this.getPreferences(),h=0,k=a[0];k<=a[1];k++)h+=parseFloat($(b.getCell(k,3)).text(),10)||0;h.toFixed&&
(h=h.toFixed(c.formats.format_prec));return h}});$.extend(!0,d,{editAppendMonth:function(){var a=this.getMaxRows(),b=$(this.getCell(a,0));b=moment(b.text());for(a=b.month();a===b.add(1,"day").month();)this.editAppendRow(),b=$(this.getCellLastRow(0)),b=moment(b.text())}})});(function(a,d,c,b){function f(b,c){this.element=b;this.settings=a.extend({},h,c);this._defaults=h;this._name="exportable";this.init()}var h={source:"table",filename:"export.csv",exports:{csv:{file_extension:"csv",media_type_text:"text/csv",media_type_data:"application/csv",col_delimiter:'","',row_delimiter:'"\r\n"',temp_col_delimiter:String.fromCharCode(11),temp_row_delimiter:String.fromCharCode(0)},json:{file_extension:"json",media_type_text:"text/plain",media_type_data:"application/json"}},charset:"utf-8"};
a.extend(f.prototype,{init:function(){var b=this,c=b.settings.filename,f=c.slice((c.lastIndexOf(".")-1>>>0)+2);a(b.element).on("click tap",function(a){b[f]()})},csv:function(){var b=this.settings,c=b.exports,f=c.csv.temp_row_delimiter,h=c.csv.temp_col_delimiter,d=c.csv.row_delimiter,q=c.csv.col_delimiter;b='"'+a(b.source).find("tr:has( td )").map(function(b,c){return a(c).find("td").map(function(b,c){return a(c).text().replace(/"/g,'""')}).get().join(h)}).get().join(f).split(f).join(d).split(h).join(q)+
'"';this.download(b,c.csv)},json:function(){var b=this.settings,c=b.exports,f=b.source,h=[];a.each(a(f).parent().find("thead > tr > th"),function(b,c){h.push(a(c).text().toLowerCase())});var d=[];a.each(a(f).find("tr"),function(b,c){var g={};a.each(a(f).find("td"),function(b,c){g[h[b]]=a(this).text().trim()});d.push(g)});d=JSON.stringify(d);this.download(d,c.json)},download:function(b,c){var f=this.settings;d.Blob&&d.URL?(b=new Blob([b],{type:c.meda_type_text+"; charset="+f.charset}),b=URL.createObjectURL(b)):
b="data:"+c.media_type_data+"; charset="+f.charset+","+encodeURIComponent(b);a(this.element).attr({download:f.filename,href:b,target:""})},table_import:function(){}});a.fn.exportable=function(b){var c;this.each(function(){a.data(this,"plugin_exportable")||(c=new f(this,b),a.data(this,"plugin_exportable",c))});return c};d.Plugin=f})(jQuery,window,document);(function(){function a(a,c){this.parent=a;this.key=c;this.children=[];this.templateIndex=null;this.links=[]}function d(a,c){var b;if("object"===typeof c)if("[object Array]"===Object.prototype.toString.apply(c)){var f=[];for(b=0;b<c.length;b++)f.push(d(a,c[b]))}else{var g=a;f={"":[]};for(b in c)Object.hasOwnProperty.call(c,b)&&(g=g.follow(b),f[""].push(d(a,c[b])));g.links.push(f)}else f=c;return f}function c(a,f){var b;if("object"===typeof f)if("[object Array]"===Object.prototype.toString.apply(f)){var d=
[];for(b=0;b<f.length;b++)d.push(c(a,f[b]))}else{d={};b=f[""][0];var g=[];for(console.log(a);0<b;)g=a[b-1].slice(1).concat(g),b=a[b-1][0];console.log(g);for(b=0;b<g.length;b++)d[g[b]]=c(a,f[""][b+1])}else d=f;return d}a.prototype.follow=function(b){b in this.children||(this.children[b]=new a(this,b));return this.children[b]};window.CJSON={};window.CJSON.stringify=function(b){var c=new a(null,"");var h=d(c,b);var k=[],g=[],n,m;c.templateIndex=0;for(m in c.children)Object.hasOwnProperty.call(c.children,
m)&&g.push(c.children[m]);for(;0<g.length;){c=g.shift();var l=0;for(m in c.children)Object.hasOwnProperty.call(c.children,m)&&(g.push(c.children[m]),l+=1);if(1<l||0<c.links.length){l=[];for(n=c;null===n.templateIndex;)l.unshift(n.key),n=n.parent;l.unshift(n.templateIndex);k.push(l);c.templateIndex=k.length;for(l=0;l<c.links.length;l++)c.links[l][""].unshift(c.templateIndex)}}return 0<k.length?JSON.stringify({f:"cjson",t:k,v:h},null,null):JSON.stringify(b)};window.CJSON.parse=function(a){a=JSON.parse(a);
return"object"===typeof a&&"f"in a&&"cjson"===a.f?c(a.t,a.v):a}})();
