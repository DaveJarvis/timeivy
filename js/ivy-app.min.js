var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,f,c){a instanceof String&&(a=String(a));for(var d=a.length,g=0;g<d;g++){var h=a[g];if(f.call(c,h,g,a))return{i:g,v:h}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,f,c){a!=Array.prototype&&a!=Object.prototype&&(a[f]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,f,c,d){if(f){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var g=a[d];g in c||(c[g]={});c=c[g]}a=a[a.length-1];d=c[a];f=f(d);f!=d&&null!=f&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:f})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var d=this;d instanceof String&&(d=String(d));var f=d.length;for(c=c||0;c<f;c++)if(d[c]==a||Object.is(d[c],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,f,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(f instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");
$(document).ready(function(){$(".ivy-export-csv").exportable({data_table:"#ivy tbody",filename:"timesheet.csv"});$(".ivy-export-json").exportable({data_table:"#ivy tbody",filename:"timesheet.json"});var a={format_time:"hh:mm A",format_date:"YYYY-MM-DD",format_prec:2,insert_rows:[{began:"7:45",ended:"9:30"},{began:"9:30",ended:"10:00"},{began:"10:00",ended:"3:45p"}],weekends:"No",columns:[]},f=$("#ivy tbody").ivy({preferences:a,init:function(){var a=this,b=this.ivy,c=this.preferences,e=b.settings.classCellReadOnly;
b=$(b.getTableBodyElement());var k="<tr>";b.prev("thead").find("tr:first th").each(function(b){k+="<td";[0,3,4].includes(b)?(k+=' class="'+e+'">',0===b&&(b=moment().startOf("month").subtract(1,"day"),b=a.getNextWorkDay(b),k+=b.format(c.format_date))):k+=">";k+="</td>"});k+="</tr>";b.append(k)},getNextWorkDay:function(a){var b=this.preferences;a=a.clone();do a.add(1,"day");while(!b.weekends&&a.toDate().isWeekend());return a},refreshCells:function(){for(var a=this.ivy.getMaxRows(),b=0;b<=a;b++)this.onCellValueChangeAfter(b,
1)},onCellValueChangeBefore:function(a,b,c){if(1===c||2===c)a=a.toTime();return a},onCellValueChangeAfter:function(a,b){if(1===b||2===b){b=this.ivy;var c=this.preferences,e=this.updateCellTime(a,1),h=this.updateCellTime(a,2,e,60);e=moment.duration(h.diff(e)).asHours();e.toFixed&&(e=Math.abs(e).toFixed(c.format_prec));$(b.getCell(a,3)).text(e);a=this.findConsecutive(a,0);c=this.sumConsecutive(a);$(b.getCell(a[0],4)).text(c)}},onRowInsertAfter:function(a,b){a=this.ivy;var c=b.find("td:eq(2)").text();
b.find("td:not(:first-child)").empty();b=b.index();a.setCellValue(c,b,1);a.refreshCells()},onRowAppendAfter:function(a,b){var c=this.ivy;b=b.find("td:first");var e=moment(b.text()),h=e.month();e=this.getNextWorkDay(e);var d=e.month();h===d?b.text(e.format(this.preferences.format_date)):a.remove();c.refreshCells()},updateCellTime:function(a,b,c,e){var d=this.preferences;a=$(this.ivy.getCell(a,b));b=a.text();""==b&&(b=moment(c).add(e,"minutes"),b=b.format(d.format_time),a.text(b));return moment.utc(b,
d.format_time)},findConsecutive:function(a,b){for(var c=this.ivy,e=a,d=$(c.getCell(a,b)).text(),f=d;d==f&&0<=--e;)f=$(c.getCell(e,b)).text();var g=e+1,h=c.getMaxRows();e=a;for(f=d;d==f&&++e<h;)f=$(c.getCell(e,b)).text();return[g,e-1]},sumConsecutive:function(a){for(var b=this.ivy,c=this.preferences,e=0,d=a[0];d<=a[1];d++)e+=parseFloat($(b.getCell(d,3)).text(),10)||0;e.toFixed&&(e=e.toFixed(c.format_prec));return e}});$.extend(!0,f,{editAppendMonth:function(){var a=this.getMaxRows(),b=$(this.getCell(a,
0));b=moment(b.text());for(a=b.month();a===b.add(1,"day").month();)this.editAppendRow(),b=$(this.getCellLastRow(0)),b=moment(b.text())}});$("#settings").dialog({dialogClass:"settings-dialog",position:{my:"right top",at:"right top",of:window}});$(".app-settings-preferences").on("click",function(a){$("#settings").dialog("open")});for(var c=[{a:"edit-cut",f:"Cut"},{a:"edit-copy",f:"Copy"},{a:"edit-undo",f:"Undo"},{a:"edit-redo",f:"Redo"},{a:"insert-shift",f:"InsertRow"},{a:"delete-row",f:"DeleteRow"},
{a:"append-day",f:"AppendRow"},{a:"append-days",f:"AppendMonth"}],d=c.length,g={i:0};g.i<d;g={i:g.i},g.i++)$(".app-"+c[g.i].a).on("click",function(a){return function(b){f["edit"+c[a.i].f]()}}(g));d=document.getElementById("editor");new JSONEditor(d,{theme:"jqueryui",disable_collapse:!0,disable_edit_json:!0,disable_properties:!0,no_additional_properties:!0,schema:{title:"Preferences",type:"object",properties:{format_time:{type:"string",title:"Time Format"},format_date:{type:"string",title:"Date Format"},
format_prec:{type:"integer",title:"Precision"},weekends:{type:"string",title:"Weekends","enum":["Yes","No"]}}},startval:a})});
