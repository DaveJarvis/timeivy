var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(c,b,a){c instanceof String&&(c=String(c));for(var f=c.length,d=0;d<f;d++){var e=c[d];if(b.call(a,e,d,c))return{i:d,v:e}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(c,b,a){c!=Array.prototype&&c!=Object.prototype&&(c[b]=a.value)};
$jscomp.getGlobal=function(c){return"undefined"!=typeof window&&window===c?c:"undefined"!=typeof global&&null!=global?global:c};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(c,b,a,f){if(b){a=$jscomp.global;c=c.split(".");for(f=0;f<c.length-1;f++){var d=c[f];d in a||(a[d]={});a=a[d]}c=c[c.length-1];f=a[c];b=b(f);b!=f&&null!=b&&$jscomp.defineProperty(a,c,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(c){return c?c:function(b,a){return $jscomp.findInternal(this,b,a).v}},"es6","es3");$jscomp.polyfill("Object.is",function(c){return c?c:function(b,a){return b===a?0!==b||1/b===1/a:b!==b&&a!==a}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(c){return c?c:function(b,a){var c=this;c instanceof String&&(c=String(c));var d=c.length;for(a=a||0;a<d;a++)if(c[a]==b||Object.is(c[a],b))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(c,b,a){if(null==c)throw new TypeError("The 'this' value for String.prototype."+a+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+a+" must not be a regular expression");return c+""};$jscomp.polyfill("String.prototype.includes",function(c){return c?c:function(b,a){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,a||0)}},"es6","es3");
$(document).ready(function(){$(".ivy-export-csv").csv({data_table:"#ivy tbody",filename:"timesheet.csv"});var c=$("#ivy tbody").ivy({preferences:{format_time:"hh:mm A",format_date:"YYYY-MM-DD",format_prec:2,insert_rows:[{began:"7:45",ended:"9:30"},{began:"9:30",ended:"10:00"},{began:"10:00",ended:"3:45p"}],weekends:!1},init:function(){var b=this,a=this.ivy,c=this.preferences,d=a.settings.classCellReadOnly;a=$(a.getTableBodyElement());var e="<tr>";a.prev("thead").find("tr:first th").each(function(a){e+=
"<td";[0,3,4].includes(a)?(e+=' class="'+d+'">',0===a&&(a=moment().startOf("month").subtract(1,"day"),console.log("first day: "+a.format(c.format_date)),a=b.getNextWorkDay(a),e+=a.format(c.format_date))):e+=">";e+="</td>"});e+="</tr>";a.append(e)},getNextWorkDay:function(b){var a=this.preferences;b=b.clone();do b.add(1,"day"),console.log(b.toDate()+" = "+b.toDate().isWeekend());while(!a.weekends&&b.toDate().isWeekend());return b},refreshCells:function(){for(var b=this.ivy.getMaxRows(),a=0;a<=b;a++)this.onCellValueChangeAfter(a,
1)},onCellValueChangeBefore:function(b,a,c){if(1===c||2===c)b=b.toTime();return b},onCellValueChangeAfter:function(b,a){if(1===a||2===a){a=this.ivy;var c=this.preferences,d=this.updateCellTime(b,1),e=this.updateCellTime(b,2,d,60);d=moment.duration(e.diff(d)).asHours();d.toFixed&&(d=Math.abs(d).toFixed(c.format_prec));$(a.getCell(b,3)).text(d);b=this.findConsecutive(b,0);c=this.sumConsecutive(b);$(a.getCell(b[0],4)).text(c)}},onRowInsertAfter:function(b,a){b=this.ivy;var c=a.find("td:eq(2)").text();
a.find("td:not(:first-child)").empty();a=a.index();b.setCellValue(c,a,1);b.refreshCells()},onRowAppendAfter:function(b,a){var c=this.ivy;a=a.find("td:first");var d=moment(a.text()),e=d.month();d=this.getNextWorkDay(d);var g=d.month();e===g?a.text(d.format(this.preferences.format_date)):b.remove();c.refreshCells()},updateCellTime:function(b,a,c,d){var e=this.preferences;b=$(this.ivy.getCell(b,a));a=b.text();""==a&&(a=moment(c).add(d,"minutes"),a=a.format(e.format_time),b.text(a));return moment.utc(a,
e.format_time)},findConsecutive:function(b,a){for(var c=this.ivy,d=b,e=$(c.getCell(b,a)).text(),g=e;e==g&&0<=--d;)g=$(c.getCell(d,a)).text();var h=d+1,k=c.getMaxRows();d=b;for(g=e;e==g&&++d<k;)g=$(c.getCell(d,a)).text();return[h,d-1]},sumConsecutive:function(b){for(var a=this.ivy,c=this.preferences,d=0,e=b[0];e<=b[1];e++)d+=parseFloat($(a.getCell(e,3)).text(),10)||0;d.toFixed&&(d=d.toFixed(c.format_prec));return d}});$.extend(!0,c,{editAppendMonth:function(){var b=this.getMaxRows(),a=$(this.getCell(b,
0));a=moment(a.text());for(b=a.month();b===a.add(1,"day").month();)this.editAppendRow(),a=$(this.getCellLastRow(0)),a=moment(a.text())}});$("#timesheet").dialog({dialogClass:"settings-dialog",position:{my:"right bottom",at:"right bottom",of:window}});$(".app-edit-undo").on("click",function(b){c.editUndo()});$(".app-edit-redo").on("click",function(b){c.editRedo()});$(".app-insert-shift").on("click",function(b){c.editInsertRow()});$(".app-delete-row").on("click",function(b){c.editDeleteRow()});$(".app-append-day").on("click",
function(b){c.editAppendRow()});$(".app-append-days").on("click",function(b){c.editAppendMonth()});$(".app-settings-timesheet").on("click",function(b){$("#timesheet").dialog("open")})});
