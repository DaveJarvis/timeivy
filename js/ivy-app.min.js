var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,e,b){a instanceof String&&(a=String(a));for(var c=a.length,d=0;d<c;d++){var f=a[d];if(e.call(b,f,d,a))return{i:d,v:f}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,b){a!=Array.prototype&&a!=Object.prototype&&(a[e]=b.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,e,b,c){if(e){b=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var d=a[c];d in b||(b[d]={});b=b[d]}a=a[a.length-1];c=b[a];e=e(c);e!=c&&null!=e&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6","es3");$jscomp.polyfill("Object.is",function(a){return a?a:function(a,b){return a===b?0!==a||1/a===1/b:a!==a&&b!==b}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,b){var c=this;c instanceof String&&(c=String(c));var d=c.length;for(b=b||0;b<d;b++)if(c[b]==a||Object.is(c[b],a))return!0;return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,e,b){if(null==a)throw new TypeError("The 'this' value for String.prototype."+b+" must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype."+b+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,b){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,b||0)}},"es6","es3");
$(document).ready(function(){$(".ivy-export-csv").exportable({data_table:"#ivy tbody",filename:"timesheet.csv"});$(".ivy-export-json").exportable({data_table:"#ivy tbody",filename:"timesheet.json"});var a=$("#ivy tbody").ivy({preferences:{format_time:"hh:mm A",format_date:"YYYY-MM-DD",format_prec:2,insert_rows:[{began:"7:45",ended:"9:30"},{began:"9:30",ended:"10:00"},{began:"10:00",ended:"3:45p"}],weekends:"No",columns:[]},init:function(){var d=this,a=this.ivy,b=this.preferences,g=a.settings.classCellReadOnly;
a=$(a.getTableBodyElement());var c="<tr>";a.prev("thead").find("tr:first th").each(function(a){c+="<td";[0,3,4].includes(a)?(c+=' class="'+g+'">',0===a&&(a=moment().startOf("month").subtract(1,"day"),a=d.getNextWorkDay(a),c+=a.format(b.format_date))):c+=">";c+="</td>"});c+="</tr>";a.append(c)},getNextWorkDay:function(a){var d=this.preferences;a=a.clone();do a.add(1,"day");while(!d.weekends&&a.toDate().isWeekend());return a},refreshCells:function(){for(var a=this.ivy.getMaxRows(),f=0;f<=a;f++)this.onCellValueChangeAfter(f,
1)},onCellValueChangeBefore:function(a,f,b){if(1===b||2===b)a=a.toTime();return a},onCellValueChangeAfter:function(a,f){if(1===f||2===f){f=this.ivy;var d=this.preferences,b=this.updateCellTime(a,1),c=this.updateCellTime(a,2,b,60);b=moment.duration(c.diff(b)).asHours();b.toFixed&&(b=Math.abs(b).toFixed(d.format_prec));$(f.getCell(a,3)).text(b);a=this.findConsecutive(a,0);d=this.sumConsecutive(a);$(f.getCell(a[0],4)).text(d)}},onRowInsertAfter:function(a,f){a=this.ivy;var b=f.find("td:eq(2)").text();
f.find("td:not(:first-child)").empty();f=f.index();a.setCellValue(b,f,1);a.refreshCells()},onRowAppendAfter:function(a,b){var f=this.ivy;b=b.find("td:first");var d=moment(b.text()),c=d.month();d=this.getNextWorkDay(d);var e=d.month();c===e?b.text(d.format(this.preferences.format_date)):a.remove();f.refreshCells()},updateCellTime:function(a,b,c,e){var d=this.preferences;a=$(this.ivy.getCell(a,b));b=a.text();""==b&&(b=moment(c).add(e,"minutes"),b=b.format(d.format_time),a.text(b));return moment.utc(b,
d.format_time)},findConsecutive:function(a,b){for(var d=this.ivy,c=a,f=$(d.getCell(a,b)).text(),e=f;f==e&&0<=--c;)e=$(d.getCell(c,b)).text();var h=c+1,k=d.getMaxRows();c=a;for(e=f;f==e&&++c<k;)e=$(d.getCell(c,b)).text();return[h,c-1]},sumConsecutive:function(a){for(var b=this.ivy,c=this.preferences,d=0,e=a[0];e<=a[1];e++)d+=parseFloat($(b.getCell(e,3)).text(),10)||0;d.toFixed&&(d=d.toFixed(c.format_prec));return d}});$.extend(!0,a,{editAppendMonth:function(){var a=this.getMaxRows(),b=$(this.getCell(a,
0));b=moment(b.text());for(a=b.month();a===b.add(1,"day").month();)this.editAppendRow(),b=$(this.getCellLastRow(0)),b=moment(b.text())}});$("#settings").dialog({dialogClass:"settings-dialog",autoOpen:!0,maxHeight:.75*$(window).height(),height:"auto",width:"auto",position:{my:"right top",at:"right top",of:window}});$(".app-settings-preferences").on("click",function(a){$("#settings").dialog("open")});for(var e=[{a:"edit-cut",f:"Cut"},{a:"edit-copy",f:"Copy"},{a:"edit-undo",f:"Undo"},{a:"edit-redo",
f:"Redo"},{a:"insert-shift",f:"InsertRow"},{a:"delete-row",f:"DeleteRow"},{a:"append-day",f:"AppendRow"},{a:"append-days",f:"AppendMonth"}],b=e.length,c={i:0};c.i<b;c={i:c.i},c.i++)$(".app-"+e[c.i].a).on("click",function(b){return function(c){a["edit"+e[b.i].f]()}}(c));b=document.getElementById("editor");new JSONEditor(b,{theme:"jqueryui",disable_collapse:!0,disable_edit_json:!0,disable_properties:!0,disable_array_reorder:!0,disable_array_delete_all_rows:!0,disable_array_delete_last_row:!0,required_by_default:!0,
no_additional_properties:!0,remove_empty_properties:!0,schema:{title:"Preferences",type:"object",properties:{weekdays:{title:"Weekdays",type:"array",format:"table",uniqueItems:!0,items:{type:"object",required:"weekday",properties:{weekday:{title:"Weekday",type:"string","enum":[0,1,2,3,4,5,6],options:{enum_titles:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ")}},times:{title:"Times",type:"array",format:"table",items:{type:"object",properties:{begin:{title:"Began",type:"string",
"default":"08:00 AM"},ended:{title:"Ended",type:"string","default":"04:00 PM"}}}}}}},formats:{title:"Format",type:"object",properties:{format_time:{type:"string",title:"Time","default":"HH:mm A"},format_date:{type:"string",title:"Date","default":"YYYY-MMM-DD"},format_prec:{type:"integer",title:"Precision","default":2}}},dates:{title:"Dates",type:"object",properties:{weekends:{type:"boolean",title:"Weekends",format:"checkbox","default":!1},holidays:{type:"boolean",title:"Holidays",format:"checkbox",
"default":!1}}}}}})});
